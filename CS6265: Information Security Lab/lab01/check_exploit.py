from pwn import *

# Choose the context
context.arch = "x86_64"

# Create a shellcode with open syscall
sh = shellcraft.open('/tmp/ok')
# Add a part of shellcode with read syscall to the prev shellcode
sh += shellcraft.read(1, 'rsp', 0x1000)
# Add a part with write syscall
sh += shellcraft.write(1, 'rsp', 'rax')
# Add an exit syscall
sh += shellcraft.exit(0)

# Check shellcode if it works
p = run_assembly(sh)
# Show the output
print(p.read())
